<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mammal Mystery - The Phylogenetic Guessing Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=Poppins:wght@300;400;600;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶å</text></svg>">
</head>
<body>
    <div class="app-container">
        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <div class="hero-section">
                <div class="logo-container">
                    <object data="mystery-mammal-logo.svg" type="image/svg+xml" class="logo-svg" aria-label="Mammal Mystery">
                        <img src="mystery-mammal-logo.svg" alt="Mammal Mystery">
                    </object>
                </div>
                
                <div class="button-container">
                    <div class="main-grid-buttons">
                        <button class="btn btn-primary" onclick="showScreen('game-screen')">
                            Start Game
                        </button>
                        <button class="btn btn-primary" onclick="showModal('rules-modal')">
                            Rules
                        </button>
                        <button class="btn btn-primary" onclick="showScreen('gallery-screen')">
                            Mammal Gallery
                        </button>
                        <button class="btn btn-primary" onclick="showModal('mammal-tree-modal')">
                            View Mammal Tree
                        </button>
                    </div>
                    <!-- Mammal Tree Modal -->
                    <div id="mammal-tree-modal" class="modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h2>Evolutionary Tree of Mammals</h2>
                                <button class="modal-close" onclick="hideModal('mammal-tree-modal')">X</button>
                            </div>
                            <div class="modal-body mammal-tree-modal-body">
                                <div class="mammal-tree-image-container" style="width: 100%; max-width: 700px;">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/0/0e/An_evolutionary_tree_of_mammals.jpeg" alt="Evolutionary Tree of Mammals" style="width: 100%; height: auto; border-radius: 8px; box-shadow: 0 2px 10px rgba(45,24,16,0.15);">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="parent">
                <!-- Left Column: Guesses 1-5 -->
                <div class="div1">
                    <div class="guess-container">
                        <div class="guess" id="try1"></div>
                        <div class="distance" id="distance1"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try2"></div>
                        <div class="distance" id="distance2"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try3"></div>
                        <div class="distance" id="distance3"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try4"></div>
                        <div class="distance" id="distance4"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try5"></div>
                        <div class="distance" id="distance5"></div>
                    </div>
                </div>
                
                <!-- Center: Image Container -->
                <div class="div2">
                    <div class="imagecontainer" id="imagecontainer"></div>
                </div>
                
                <!-- Right Column: Guesses 6-10 -->
                <div class="div3">
                    <div class="guess-container">
                        <div class="guess" id="try6"></div>
                        <div class="distance" id="distance6"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try7"></div>
                        <div class="distance" id="distance7"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try8"></div>
                        <div class="distance" id="distance8"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try9"></div>
                        <div class="distance" id="distance9"></div>
                    </div>
                    <div class="guess-container">
                        <div class="guess" id="try10"></div>
                        <div class="distance" id="distance10"></div>
                    </div>
                </div>
                
                <!-- Bottom: Answer Grid -->
                <div class="grid-container" id="options-grid">
                    <!-- Mammal buttons will be populated here -->
                </div>
            </div>
        </div>

        <!-- Gallery Screen -->
        <div id="gallery-screen" class="screen">
            <div class="gallery-header">
                <button class="btn-back" onclick="showScreen('home-screen')">
                    <span>‚Üê Back</span>
                </button>
                <h2>Mammal Gallery</h2>
                <div class="gallery-filters">
                    <div class="gallery-search">
                        <input type="text" id="gallery-search" placeholder="Search mammals..." class="search-input">
                    </div>
                    <div class="gallery-dropdowns">
                        <select id="order-filter" class="filter-select">
                            <option value="">All Orders</option>
                        </select>
                        <select id="family-filter" class="filter-select">
                            <option value="">All Families</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="gallery-content" id="gallery-content">
                <!-- Gallery items will be populated here -->
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="resultModal" class="modal">
        <div class="modal-content">
            <div class="modal-body modal-body--centered">
                <p class="resultmessage" id="resultMessage"></p>
                <button id="playAgainBtn">Play Again</button>
            </div>
        </div>
    </div>

    <div id="rules-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Rules</h2>
                <button class="modal-close" onclick="hideModal('rules-modal')">X</button>
            </div>
            <div class="modal-body">
                <div class="rules-section">
                    <h3>
                        <span class="rules-icon" aria-hidden="true">
                            <!-- whale.svg (fill uses currentColor) -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45.62 37.35" role="img" focusable="false">
                                <g id="Layer_1-2" data-name="Layer 1">
                                    <g id="whale">
                                        <path fill="currentColor" d="M3.81,24.43c-.5,1.65-.77,3.32-.08,3.9.22.19.82.54,1.71-.2.46-.38.95-.88,1.41-1.42,4.12,2.44,9.88,3.67,17.23,3.67,3.49,0,7.35-.28,11.56-.83-.27,2.78.43,6.83,1.38,7.57.18.15.4.22.62.22.13,0,.25-.03.37-.08.56-.24.73-.88.81-1.77v-.10c.13-1.4.22-2.42.57-2.7.47-.38,2.17-.19,3.72.02.74.1,2.12.28,2.44-.72.17-.53.44-1.41-4.95-4.23-5.21-12.92-13.79-16.7-20.1-17.59-6.28-.89-11.46.82-12.47,1.18-1.02-.05-5.26-.12-7.13,1.79C.27,13.81-.04,14.65.01,15.59c-.04.54-.23,4.94,3.8,8.85ZM4.41,22.71c-.96-1.05-1.59-2.12-2-3.09.91.63,1.94,1.02,2.8,1.23-.18.37-.48,1.05-.8,1.86ZM7.89,25.44c.69-.91,1.29-1.79,1.67-2.37,4.95,2.78,8.93,2.42,12.79,2.08,1.28-.12,2.5-.23,3.74-.22,3.01.02,6.09,1.81,8,3.17-8.81,1.04-19.44,1.16-26.2-2.67ZM2.07,14.3c1.27-1.3,4.79-1.38,6.04-1.3.12,0,.24-.01.35-.05.05-.02,5.38-2.06,11.82-1.15,7.37,1.04,13.09,5.34,17.06,12.8.26.49.52,1,.76,1.51.39.81.76,1.66,1.1,2.54.07.18.21.33.38.42,1.19.61,2.5,1.38,3.39,1.98-2.47-.32-3.74-.32-4.61.37-.56.45-.81,1.07-.96,1.95-.2-1.31-.3-2.91-.07-4.23.04-.26-.04-.51-.22-.7-.01-.01-.02-.02-.03-.04-.04-.04-.26-.24-.62-.53-.18-.15-.41-.33-.66-.53-1.93-1.49-5.78-4.02-9.71-4.04h-.13c-1.28,0-2.54.11-3.77.22-3.95.35-7.67.68-12.48-2.25-.38-.23-.88-.11-1.12.27-.01.02-.95,1.52-2.09,3.02-.17.22-.34.43-.51.64-.18.22-.36.42-.54.62-.15.17-.3.33-.45.48.04-.21.1-.45.16-.7.07-.27.15-.55.24-.84.08-.28.17-.56.27-.83.34-1,.73-1.97,1.06-2.52.38-.63.89-1.49.24-2.04-.19-.17-.57-.36-1.13-.05-.94-.19-3.76-.97-4.17-3.47-.02-.1-.04-.19-.04-.3-.04-.51.1-.9.43-1.25Z"/>
                                        <path fill="currentColor" d="M18,4.01c-.2-.97-.98-1.79-1.89-1.99-.79-.17-1.54.13-2.06.83-1.07,1.44.23,2.65.93,3.29.18.17.35.33.48.47.58.66.69,1.26.85,2.18l.06.33c.05.28.28.49.56.53.03,0,.05,0,.08,0,.25,0,.48-.15.59-.38.09-.19.12-.4.09-.6.02-.49.11-1.01.19-1.56.16-1.03.33-2.1.12-3.11ZM16.71,6.1c-.08-.12-.17-.23-.28-.35-.17-.19-.36-.37-.57-.56-.93-.86-1.07-1.15-.77-1.56.17-.24.37-.35.59-.35.05,0,.1,0,.15.02.41.09.79.51.89.98.11.55.07,1.18-.01,1.82Z"/>
                                        <path fill="currentColor" d="M19.31,5.34h.65c0-.24.4-.7,1.06-1.05.23-.12.78-.21,1.26-.28.98-.15,1.9-.3,2.34-.87.46-.6.48-1.34.06-1.98-.55-.83-1.7-1.32-2.57-1.1-2.06.52-3.35,3.37-3.45,5.14h0s0,.1,0,.14h.65ZM22.43,1.32s.08-.01.12-.01c.32,0,.82.23,1.04.57.14.21.1.33,0,.46-.17.17-1.04.31-1.51.38-.52.08-1.02.16-1.42.31.45-.83,1.07-1.53,1.76-1.7Z"/>
                                    </g>
                                </g>
                            </svg>
                        </span>
                        Did you know?
                    </h3>
                    <p>Dolphins are more closely related to cows than they are to seals.</p>
                    <p>Family ties among mammals are often surprising and mysterious. Your job is to dig through the branches of the tree and uncover those hidden relationships.</p>
                </div>

                <div class="rules-section">
                    <h3>
                        <span class="rules-icon" aria-hidden="true">
                            <!-- target.svg -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 39.51 38.48" role="img" focusable="false">
                                <g id="Layer_1-2" data-name="Layer 1">
                                    <g id="target">
                                        <path fill="currentColor" d="M15.54,38.48c8.57,0,15.55-6.97,15.55-15.55,0-4.05-1.56-7.75-4.11-10.52l2.93-2.93c.1.15.27.25.46.27l6.12.67s.05,0,.07,0c.33,0,.61-.25.65-.58.04-.36-.22-.68-.58-.72l-5.74-.63,1.68-1.68s.05.01.08.02l6.12.67s.05,0,.07,0c.33,0,.61-.25.65-.58.04-.36-.22-.68-.58-.72l-5.17-.57,3.14-3.14c.25-.25.25-.67,0-.92-.25-.25-.67-.25-.92,0l-3.22,3.22-1.7-4.39c-.13-.34-.51-.5-.84-.37-.34.13-.5.51-.37.84l1.89,4.87s.02.03.03.05l-1.39,1.39-1.7-4.54c-.13-.34-.5-.51-.84-.38-.34.13-.51.5-.38.84l1.89,5.02s.02.04.03.06l-3.29,3.29c-2.77-2.55-6.46-4.11-10.52-4.11C6.97,7.38,0,14.36,0,22.93s6.97,15.55,15.54,15.55ZM15.54,8.69c3.69,0,7.06,1.41,9.59,3.73l-3.08,3.08c-1.74-1.53-4.02-2.46-6.52-2.46-5.46,0-9.9,4.44-9.9,9.9s4.44,9.9,9.9,9.9,9.9-4.44,9.9-9.9c0-2.49-.93-4.77-2.46-6.52l3.08-3.08c2.31,2.53,3.73,5.9,3.73,9.59,0,7.85-6.39,14.24-14.24,14.24S1.3,30.78,1.3,22.93s6.39-14.24,14.24-14.24ZM15.08,23.39c.13.13.29.19.46.19s.33-.06.46-.19l2.01-2.01c.28.45.45.98.45,1.55,0,1.61-1.31,2.92-2.92,2.92s-2.92-1.31-2.92-2.92,1.31-2.92,2.92-2.92c.57,0,1.1.17,1.55.45l-2.01,2.01c-.25.25-.25.67,0,.92ZM18.03,19.52c-.7-.51-1.55-.82-2.48-.82-2.33,0-4.22,1.89-4.22,4.22s1.89,4.22,4.22,4.22,4.22-1.89,4.22-4.22c0-.93-.31-1.79-.82-2.48l3.11-3.11c1.29,1.5,2.08,3.46,2.08,5.59,0,4.74-3.85,8.59-8.59,8.59s-8.59-3.85-8.59-8.59,3.85-8.59,8.59-8.59c2.13,0,4.09.78,5.59,2.08l-3.11,3.11Z"/>
                                    </g>
                                </g>
                            </svg>
                        </span>
                        Objective
                    </h3>
                    <p>Guess the mystery mammal in 10 tries or fewer.</p>
                </div>
                
                <div class="rules-section">
                    <h3>
                        <span class="rules-icon" aria-hidden="true">
                            <!-- map.svg -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34.32 33.4" role="img" focusable="false">
                                <g id="Layer_1-2" data-name="Layer 1">
                                    <g id="map">
                                        <path fill="currentColor" d="M5.85,9.72c-.02-.13-.13-.23-.27-.21-.22.03-.4.05-.53.07-.18.03-.29.05-.29.05-.13.03-.21.16-.19.29.03.11.13.19.24.19.02,0,.04,0,.05,0,0,0,.29-.06.78-.12,0,0,.02,0,.02,0,.12-.03.21-.14.19-.26Z"/>
                                        <path fill="currentColor" d="M27.99,21.26c-.1.08-.19.16-.29.24-.11.08-.13.24-.04.34.05.06.12.09.19.09.05,0,.10-.02.14-.04,0,0,0,0,.01,0,.11-.08.21-.17.31-.26.32-.28.63-.59.93-.93.09-.10.08-.26-.02-.34-.10-.09-.26-.08-.34.02-.18.21-.37.41-.57.59-.11.10-.22.20-.33.30Z"/>
                                        <path fill="currentColor" d="M14.75,12.79s.11.07.17.07.12-.02.17-.07c.10-.10.10-.25,0-.35-.16-.17-.34-.32-.51-.48-.11-.09-.22-.18-.33-.27-.16-.12-.31-.25-.48-.37-.11-.08-.26-.05-.34.06-.08.11-.05.26.06.34.26.18.51.39.76.6.11.10.22.20.33.30.05.05.11.10.17.15Z"/>
                                        <path fill="currentColor" d="M16.62,15.46c.04.09.13.14.22.14.04,0,.07,0,.11-.02.12-.06.17-.21.11-.33-.17-.35-.37-.69-.57-1.01-.10-.16-.20-.32-.30-.47,0,0-.02-.02-.02-.02-.08-.09-.21-.11-.32-.04-.11.08-.14.23-.06.34.13.19.25.39.38.59.11.19.22.39.33.59.04.08.09.16.13.24Z"/>
                                        <path fill="currentColor" d="M20.17,21.3s.07.03.11.03c.06,0,.13-.02.17-.07.09-.10.09-.25,0-.35-.09-.09-.18-.19-.28-.28-.11-.12-.22-.24-.33-.37-.16-.19-.32-.39-.47-.59-.08-.11-.23-.13-.34-.05-.11.08-.13.23-.05.34.28.37.57.72.86,1.03.09.09.17.18.26.27.02.02.04.03.07.04Z"/>
                                        <path fill="currentColor" d="M18.27,18.64s.05-.01.08-.02c.01,0,.03,0,.04-.01.12-.07.16-.22.09-.33-.05-.08-.09-.17-.14-.25-.11-.2-.22-.41-.33-.63-.10-.20-.19-.39-.28-.6-.06-.12-.2-.18-.32-.12-.12.05-.18.20-.12.32.23.51.47,1,.73,1.45.01.02.02.05.04.07.04.08.13.12.21.12Z"/>
                                        <path fill="currentColor" d="M8.93,10.02s.02,0,.03,0c.12,0,.23-.09.24-.21.02-.13-.08-.26-.21-.27-.22-.03-.44-.05-.67-.07-.11,0-.22-.02-.33-.02-.24-.01-.47-.03-.71-.03h0c-.13,0-.24.11-.25.24,0,.13.11.25.24.25.24,0,.48.01.72.03.11,0,.22.02.33.03.2.02.41.04.6.06Z"/>
                                        <path fill="currentColor" d="M29.95,19.38s.09.04.13.04c.03,0,.05-.01.08-.02.05-.02.09-.04.12-.09.15-.23.29-.47.43-.71.07-.12.03-.27-.09-.33-.12-.07-.27-.02-.33.09-.04.07-.09.14-.13.21-.09.16-.19.32-.29.47-.07.11-.04.26.07.34Z"/>
                                        <path fill="currentColor" d="M10.17.07c-.15-.09-.33-.09-.48-.02L.26,4.96c-.16.08-.26.25-.26.43v27.11c0,.17.09.33.24.42.08.05.17.07.25.07.08,0,.15-.02.23-.06l9.43-4.91c.16-.08.26-.25.26-.43V10.25s.08.08.13.1c.51.14,1,.33,1.47.54v17.12c0,.18.1.35.26.43l9.43,4.91c.07.04.15.06.23.06.09,0,.18-.02.25-.07.15-.09.24-.25.24-.42v-10.1c.21.09.43.16.64.22.02,0,.04,0,.06,0,.11,0,.21-.07.24-.18.04-.13-.04-.26-.17-.3-.26-.07-.52-.16-.77-.28V5.8c0-.18-.1-.35-.26-.43L12.73.46c-.15-.08-.33-.07-.48.02-.15.09-.24.25-.24.42v9.47c-.43-.18-.88-.35-1.34-.48-.11-.03-.21.02-.27.10V.49c0-.17-.09-.33-.24-.42ZM9.43,27.31l-1.1.57-.33.17-1.59.83-.33.17-1.53.80-.20.10-1.63.85-.18.09-1.56.81V5.70l3.29-1.71.14-.07,5.02-2.62v26.01ZM12.99,1.70l1.27.66.33.17,1.59.83.33.17,1.52.79.33.17,3.09,1.61v15.84s-.04.03-.05.06c-.06.10-.04.24.05.31v9.80l-1.27-.66-.33-.17-1.50-.78-.33-.17-1.52-.79-.33-.17-1.59-.83-.33-.17-1.27-.66V1.70Z"/>
                                    </g>
                                </g>
                            </svg>
                        </span>
                        How to Play
                    </h3>
                    <ol>
                        <li>A random mammal is chosen as your target</li>
                        <li>Select mammals from the grid to make your guesses</li>
                        <li>After each guess, you‚Äôll see how that guess ranks among all species by proximity (lower is closer)</li>
                        <li>Each new guess is also marked as <strong>closer</strong> or <strong>farther</strong> compared to your previous guess</li>
                        <li>Find the exact match to win!</li>
                        <li>At the end of a round, you can view a full list of all species ranked by proximity to the target</li>
                    </ol>
                </div>

                <div class="rules-section">
                    <h3>
                        <span class="rules-icon" aria-hidden="true">
                            <!-- light.svg -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22.69 35.76" role="img" focusable="false">
                                <g id="Layer_1-2" data-name="Layer 1">
                                    <g id="light">
                                        <path fill="currentColor" d="M9.34,5.91C4.19,5.91,0,10.10,0,15.25c0,1.20.07,2.26.45,3.80.67,2.72,2.31,6.46,2.87,7.68-.25.34-.39.74-.39,1.16,0,.53.20,1.02.56,1.40-.35.37-.55.85-.56,1.36,0,.60.25,1.14.69,1.54-.32.36-.50.82-.50,1.31-.01,1.17,1.01,2.13,2.27,2.15l8.43.11s.02,0,.03,0c.63,0,1.23-.24,1.66-.66.40-.39.62-.90.62-1.43,0-.60-.25-1.14-.69-1.54.32-.36.50-.82.50-1.31,0-.53-.20-1.02-.56-1.40.35-.37.55-.85.56-1.36,0-.53-.20-1.01-.54-1.38.58-1.28,2.18-4.94,2.84-7.63.37-1.54.45-2.60.45-3.80,0-5.15-4.19-9.34-9.34-9.34ZM14.59,34.17c-.19.19-.47.30-.77.29l-8.43-.11c-.55,0-.99-.38-.99-.83,0-.35.28-.65.68-.76.30-.08.50-.35.48-.66-.01-.31-.24-.56-.54-.61-.47-.08-.81-.42-.80-.81,0-.33.26-.63.64-.75.27-.08.46-.34.46-.62,0-.29-.18-.54-.45-.62-.39-.12-.65-.43-.64-.77,0-.16.06-.29.13-.39h10.04c.15.15.24.33.24.53,0,.33-.26.63-.64.75-.27.08-.46.34-.46.62,0,.28.18.54.45.62.39.12.65.43.64.77,0,.35-.28.65-.68.76-.30.08-.50.35-.48.66.01.31.24.56.54.61.46.08.81.43.80.81,0,.24-.13.41-.23.51ZM16.97,18.74c-.64,2.59-2.26,6.29-2.79,7.47H4.50c-.53-1.18-2.15-4.87-2.79-7.46-.34-1.42-.41-2.39-.41-3.49,0-4.43,3.61-8.04,8.04-8.04s8.04,3.61,8.04,8.04c0,1.11-.07,2.08-.41,3.49Z"/>
                                        <path fill="currentColor" d="M22.18,5.17l-3.97,2.18c-.16.09-.22.30-.13.46.04.06.09.11.15.14.10.05.21.05.31,0l3.97-2.18c.16-.09.22-.30.13-.46-.09-.16-.30-.22-.46-.13Z"/>
                                        <path fill="currentColor" d="M16.29,6.38c.20.05.41-.07.47-.27l1.77-5.59c.07-.21-.05-.43-.26-.50-.21-.07-.43.05-.50.26l-1.77,5.59c-.07.21.05.43.26.50,0,0,.02,0,.03,0Z"/>
                                        <path fill="currentColor" d="M8.08,8.94c-1.46.03-4.29.94-4.50,4.15-.03.43.30.80.73.83h0c.43.03.80-.30.83-.73.01-.21.04-.40.09-.60.33-1.29,1.37-1.79,2.19-1.99.38-.09.67-.10.70-.10.43-.01.77-.37.76-.80,0-.42-.36-.76-.80-.76Z"/>
                                    </g>
                                </g>
                            </svg>
                        </span>
                        Strategy Tips
                    </h3>
                    <ul>
                        <li>Start with mammals from different orders (e.g., primates, carnivores, ungulates)</li>
                        <li>Have a look at the <strong><a href="#" onclick="hideModal('rules-modal'); showModal('mammal-tree-modal'); return false;">Mammal Tree</a></strong> for a helpful overview of major mammal family relationships. Or browse through the <strong><a href="#" onclick="hideModal('rules-modal'); showScreen('gallery-screen'); return false;">Mammal Gallery</a></strong> to familiarize yourself with all the different mammal species out threre. You can access both from the main menu.</li>
                        <li>Consider habitat, diet, and size similarities</li>
                        <li>The search function can help you find specific mammals quickly</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="result-modal" class="modal">
        <div class="modal-content result-modal">
            <div class="modal-header">
                <h2 id="result-modal-title">Game Over</h2>
                <button class="modal-close" onclick="hideModal('result-modal')">X</button>
            </div>
            <div class="modal-body">
                <div class="result-content" id="result-content">
                    <!-- Result content will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <div id="round-tree-modal" class="modal">
        <div class="modal-content tree-modal">
            <div class="modal-header">
                <h2>All species ranked by proximity</h2>
                <button class="modal-close" onclick="hideModal('round-tree-modal')">X</button>
            </div>
            <div class="modal-body">
                <div class="round-tree-container">
                    <div class="round-tree-svg" id="round-tree-svg">
                        <!-- Tree visualization will render here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="mammal-info-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="mammal-info-title">Mammal Information</h2>
                <button class="modal-close" onclick="hideModal('mammal-info-modal')">X</button>
            </div>
            <div class="modal-body" id="mammal-info-body">
                <!-- Mammal info will be populated here -->
            </div>
        </div>
    </div>

    <!-- Load PhyloJS dependency first (required for phylogenetic calculations) -->
    <script>
        (function loadDependencies() {
            const resources = [
                {
                    type: 'script',
                    name: 'phylojs',
                    sources: [
                        '../node_modules/phylojs/lib/dist/phylojs.min.js',
                        'https://unpkg.com/phylojs@1.12.0/lib/dist/phylojs.min.js'
                    ]
                }
            ];

            function injectScript(src, onload, onerror) {
                const script = document.createElement('script');
                script.src = src;
                script.onload = onload;
                script.onerror = onerror;
                document.head.appendChild(script);
            }

            function loadGame() {
                if (window._gameLoaded) return;
                window._gameLoaded = true;
                
                // Load the main module
                const script = document.createElement('script');
                script.type = 'module';
                script.src = 'js/main.js';
                document.body.appendChild(script);
            }

            function loadResource(index, sourceIndex) {
                if (index >= resources.length) {
                    loadGame();
                    return;
                }

                const resource = resources[index];
                const sources = resource.sources || [];
                const currentIndex = sourceIndex || 0;

                if (!sources[currentIndex]) {
                    console.error(`Failed to load ${resource.name}; skipping.`);
                    loadResource(index + 1, 0);
                    return;
                }

                const onSuccess = () => loadResource(index + 1, 0);
                const onFailure = () => {
                    if (currentIndex + 1 < sources.length) {
                        console.warn(`Failed to load ${resource.name} from ${sources[currentIndex]}, trying fallback.`);
                        loadResource(index, currentIndex + 1);
                    } else {
                        console.error(`Failed to load ${resource.name} from all sources.`);
                        loadResource(index + 1, 0);
                    }
                };

                injectScript(sources[currentIndex], onSuccess, onFailure);
            }

            loadResource(0, 0);
        })();
    </script>
</body>
</html>
